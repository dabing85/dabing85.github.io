<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://blog.dabing.cool</id>
    <title> • Posts by &#34;ssl&#34; tag</title>
    <link href="https://blog.dabing.cool" />
    <updated>2022-09-05T13:46:25.000Z</updated>
    <category term="算法" />
    <category term="成功日记" />
    <category term="打卡" />
    <category term="脱发" />
    <category term="补牙" />
    <category term="Hexo" />
    <category term="Valine-Admin" />
    <category term="ssl" />
    <category term="https" />
    <category term="git" />
    <category term="RabbitMQ" />
    <category term="Redis" />
    <category term="Jedis" />
    <category term="JVM" />
    <category term="Java新特性" />
    <category term="微服务" />
    <category term="SpringCloud" />
    <entry>
        <id>https://blog.dabing.cool/hexo/ssl/</id>
        <title>服务器配置hexo开启https（ssl证书）</title>
        <link rel="alternate" href="https://blog.dabing.cool/hexo/ssl/"/>
        <content type="html">&lt;p&gt;作者：dabing（王甜甜）&lt;/p&gt;
&lt;p&gt;参加了又拍云的联盟活动，白嫖的 10G 的存储空间 + 15GB 的 CDN 免费流量，有域名并且已经备案的有网站的小伙伴也可以去试试：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudXB5dW4uY29tL2xlYWd1ZQ==&#34;&gt;又拍云联盟 - 开发者帮助计划，为开发者加速 - 又拍云 (upyun.com)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;http://image.dabing.cool/image/image-20220909084820511.png&#34; alt=&#34;image-20220909084820511&#34;&gt;&lt;/p&gt;
&lt;p&gt;顺便申请了免费的 SSL 证书，你看我的小站现在是 https 开头的啦～～～&lt;/p&gt;
&lt;p&gt;一些申领过程可以参考我友链中余白的博客：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudmlweXViYWkudG9wL3Bvc3QvYTQyYmVmYzYuaHRtbA==&#34;&gt;hexo 的优化：又拍云 cdn 加速 | 余白の小屋 (vipyubai.top)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;我这里只是记录一下我在服务器 nginx 如何开启 https（SSL 证书）&lt;/p&gt;
&lt;h1 id=&#34;获取证书&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#获取证书&#34;&gt;#&lt;/a&gt; 获取证书&lt;/h1&gt;
&lt;p&gt;先从你的又拍云平台把已经颁发了的证书下载下来。&lt;/p&gt;
&lt;p&gt;我的下载下来有两个文件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;blog.dabing.cool.crt&lt;/li&gt;
&lt;li&gt;blog.dabing.cool.key&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;http://image.dabing.cool/image/image-20220909085441872.png&#34; alt=&#34;image-20220909085441872&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;服务器配置nginx&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#服务器配置nginx&#34;&gt;#&lt;/a&gt; 服务器配置 nginx&lt;/h1&gt;
&lt;p&gt;我参考的这篇文章：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC84NTA0MDYyNQ==&#34;&gt;Nginx 配置 SSL 证书&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;懒得再写一次了，这里记录一下我的配置&lt;/p&gt;
&lt;h2 id=&#34;1-先检测一下自己的环境是否允许&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1-先检测一下自己的环境是否允许&#34;&gt;#&lt;/a&gt; 1. 先检测一下自己的环境是否允许：&lt;/h2&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;nginx &lt;span class=&#34;token parameter variable&#34;&gt;-V&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;看到这个 &lt;code&gt;--with-stream_ssl_module&lt;/code&gt;  那就 ok&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;http://image.dabing.cool/image/image-20220909090711795.png&#34; alt=&#34;image-20220909090711795&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;openssl version&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;http://image.dabing.cool/image/image-20220909090843974.png&#34; alt=&#34;image-20220909090843974&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;rpm&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-qa&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;grep&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;open&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# 查询是否安装 openssl&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;http://image.dabing.cool/image/image-20220909091040936.png&#34; alt=&#34;image-20220909091040936&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;2-confd的文件配置&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2-confd的文件配置&#34;&gt;#&lt;/a&gt; 2. conf.d/ 的文件配置&lt;/h2&gt;
&lt;p&gt;再你的 etc/nginx/conf.d/ 文件夹下创建一个文件，我的是 &lt;code&gt;etc/nginx/conf.d/blog.conf&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;我的配置内容如下：&lt;/p&gt;
&lt;p&gt;值得注意的是：# 如果你的 ssl on 爆红或者你的 nginx 是 1.15.x 以上版本的话&lt;/p&gt;
&lt;p&gt;得将 &lt;code&gt;listen 443&lt;/code&gt;  和 &lt;code&gt;ssl on&lt;/code&gt;  改成 &lt;code&gt;listen 443 ssl &lt;/code&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;figcaption data-lang=&#34;nginx&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;listen&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;443&lt;/span&gt; ssl&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# 如果你的 ssl on 爆红或者你的 nginx 是 1.15 以上版本的话，&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server_name&lt;/span&gt; blog.dabing.cool&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;     &lt;span class=&#34;token comment&#34;&gt;# 填写绑定证书的域名&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;ssl_certificate&lt;/span&gt; /etc/nginx/cert/blog.dabing.cool.crt&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;ssl_certificate_key&lt;/span&gt; /etc/nginx/cert/blog.dabing.cool.key&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;ssl_session_timeout&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5m&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;ssl_protocols&lt;/span&gt; TLSv1 TLSv1.1 TLSv1.2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;    &lt;span class=&#34;token comment&#34;&gt;# 按照这个协议配置&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;ssl_ciphers&lt;/span&gt; ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;     &lt;span class=&#34;token comment&#34;&gt;# 按照这个套件配置&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;ssl_prefer_server_ciphers&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;on&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;location&lt;/span&gt; /&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt; /var/www/hexo&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;    &lt;span class=&#34;token comment&#34;&gt;# 站点目录&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;index&lt;/span&gt;  index.html index.htm&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;listen&lt;/span&gt;       &lt;span class=&#34;token number&#34;&gt;80&lt;/span&gt; default_server&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;listen&lt;/span&gt;       [::]:80 default_server&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;server_name&lt;/span&gt;  xxx.xx.xxx.xx&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# 这里可以填你的主机 ip&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;root&lt;/span&gt;         /var/www/hexo&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token directive&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;rewrite&lt;/span&gt; ^(.*) https://blog.dabing.cool&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;   &lt;span class=&#34;token comment&#34;&gt;# 添加的语句&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;然后重启 nginx 即可：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;systemctl restart nginx.service&lt;/code&gt;  重启&lt;/p&gt;
&lt;p&gt;如果你遇到类似这样的错误：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Job &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; nginx.service failed because the control process exited with error code. See &lt;span class=&#34;token string&#34;&gt;&#34;systemctl status nginx.service&#34;&lt;/span&gt; and &lt;span class=&#34;token string&#34;&gt;&#34;journalctl -xe&#34;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; details.&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;有可能是你的 80 端口或者 443 端口被占用着，命令查看一下&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;ps&lt;/span&gt; -ef&lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;grep&lt;/span&gt; nginx&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;有就把进程杀掉，再重启即可。&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;kill&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-9&lt;/span&gt; pid&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;再访问看看：&lt;a href=&#34;https://blog.dabing.cool/&#34;&gt;https://blog.dabing.cool/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;http://image.dabing.cool/image/image-20220909100723165.png&#34; alt=&#34;image-20220909100723165&#34;&gt;&lt;/p&gt;
</content>
        <category term="Hexo" />
        <category term="ssl" />
        <category term="https" />
        <updated>2022-09-05T13:46:25.000Z</updated>
    </entry>
</feed>
